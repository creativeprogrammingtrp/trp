<style type="text/css">
#tooltip
{
	z-index: 9999 !important;
	position:absolute !important;
	background-color: #FFF;
	border: 1px solid #6F13CC;
	border-radius:5px;
}
.member{
	float:left;
	/*border:1px dotted #999;*/
	border: 1px solid #6F13CC;
	border-radius:2px;
	padding:3px 8px;
	margin-left:10px;
	margin-top:6px;
	cursor:pointer;
}
.member:hover{
	color:#B4285D;
	background:#e5e5e5
}
.upline{
	/*border:1px dotted #999;*/
	border: 1px solid #6F13CC;
	border-radius:2px;
	padding:3px 8px;
	cursor:pointer;
}
.upline:hover{
	color:#B4285D;
	background:#e5e5e5
}
.member_active{
	color:#B4285D;
	float:left;
	/*border:1px dotted #999;*/
	border: 1px solid #6F13CC;
	border-radius:2px;
	padding:3px 8px;
	margin-left:10px;
	margin-top:6px;
	cursor:pointer;
	background:#e5e5e5
}
.summarySale{
	-webkit-border-radius: 5px;
	-moz-border-radius: 5px;
	border-radius: 5px;
	background:#CCC;
	width:100%; overflow:hidden; clear:both;
}
thead tr .td-row{
	background: #fdfdfd; /* Old browsers */
	background: -moz-linear-gradient(top,  #fdfdfd 0%, #efefef 100%); /* FF3.6+ */
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#fdfdfd), color-stop(100%,#efefef)); /* Chrome,Safari4+ */
	background: -webkit-linear-gradient(top,  #fdfdfd 0%,#efefef 100%); /* Chrome10+,Safari5.1+ */
	background: -o-linear-gradient(top,  #fdfdfd 0%,#efefef 100%); /* Opera 11.10+ */
	background: -ms-linear-gradient(top,  #fdfdfd 0%,#efefef 100%); /* IE10+ */
	background: linear-gradient(to bottom,  #fdfdfd 0%,#efefef 100%); /* W3C */
	filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f1f1f1', endColorstr='#f1f1f1',GradientType=0 ); /* IE6-9 */
}
.td-row {
	padding-bottom:5px;
	padding-top:5px;
	padding-left:3px;
	padding-right:3px;
	border-bottom:1px solid #d3d3d3;
}
</style>
<div class="main-container holder">
    <div style="clear:both; overflow:hidden; margin-bottom:20px">
        <div style="float:right">
            {addnewbt}
        </div>
        <div class="upline" style="float:right;"><img src="../images/icon_p.png" border="0" align="absmiddle" />&nbsp;Upline Information</span></div>
    </div>
    <div style="clear:both; width:100%; overflow:hidden; margin-bottom:20px;" id="tab_2_content">
        <div style="clear:both; width:100%; overflow:hidden">
            <span style="float:left; clear:both; font-weight:bold; text-shadow:0px 1px 1px #999; height:30px;">1.&nbsp;&nbsp;Summary</span>
            {exportbt}
            <div style="width:100%; clear:both;">
            <div class="grid-cols" style="width:100%">
            	<div class="col50" style="margin-bottom:10px;">
                	<table cellpadding="0" cellspacing="0" border="0" style="float:left;">
                        <tr>
                            <td align="left" valign="top">
                                <div style="clear:both; font-weight:bold">{legal_business_name}</div>
                                <div style="clear:both; padding-top:2px">
                                    <span style="float:left; text-align:left; font-weight:bold">ID#:</span>
                                    <span style="float:left; padding-left:10px">{legal_business_id}</span>
                                </div>
                                <div style="clear:both; padding-top:2px">
                                    <span style="float:left; text-align:left; font-weight:bold">Address:</span>
                                    <span style="float:left; padding-left:10px">{Address}</span>
                                </div>
                                <div style="clear:both; padding-top:2px">
                                    <span style="float:left; text-align:left; font-weight:bold">Member since:</span>
                                    <span style="float:left; padding-left:10px">{Member_since}</span>
                                </div>
                                <div style="clear:both; padding-top:2px">
                                    <span style="float:left; text-align:left; font-weight:bold">Last login:</span>
                                    <span style="float:left; padding-left:10px">{last_login}</span>
                                </div>
                                <div style="clear:both; padding-top:2px">
                                    <span style="float:left; text-align:left; font-weight:bold">Total Downline Members:</span>
                                    <span style="float:left; padding-left:10px" id="total_downline_member"></span>
                                </div>
                                <div style="clear:both; padding-top:20px">
                                    <span style="float:left; text-align:left; font-weight:bold">Calendar's month:</span>
                                    <span style="float:left; padding-left:10px">{Calendar}</span>
                                </div>
                                <div style="clear:both; padding-top:2px; display:none">
                                    <span style="float:left; text-align:left; font-weight:bold">Remaining Time:</span>
                                    <span style="float:left; padding-left:10px" class="Remaining_Time"></span>
                                </div>
                                <div style="clear:both; padding-top:2px">
                                    <span style="float:left; text-align:left; font-weight:bold">Current Purchase:</span>
                                    <span style="float:left; padding-left:10px">${Purchase}</span>
                                </div>
                            </td>
                        </tr>
                    </table>
            		<p style="clear:both; padding-top:10px;" class="italic color-orange"> Must purchase within each month in order to receive commissions of your downline per month</p>
				</div>
                <div class="col50">
                	<table cellpadding="0" cellspacing="0" border="0" style="float:right;">
                                <tr>
                                    <td align="left" valign="middle" style="padding-bottom:5px" width="175px"><b>YTD Total Earning (<span id="year_current"></span>):</b></td>
                                    <td align="right" valign="middle" style="padding-bottom:5px; padding-left:10px">$<span id="YTD_Earnings"></span></td>
                                </tr>
                                <tr>
                                    <td align="left" valign="middle" style="border-bottom:1px solid #CCC; padding-bottom:5px"><b>YTD Personal Discount:</b></td>
                                    <td align="right" valign="middle" style="border-bottom:1px solid #CCC; padding-bottom:5px; padding-left:10px">$<span id="YTD_Personal_Discount"></span></td>
                                </tr>
                                <tr>
                                    <td align="left" valign="top" style="padding-top:5px"><b>Pending Earning:</b><p class="italic color-orange" style="font-size:11px">This amount is earned upon your  purchased</p></td>
                                    <td align="right" valign="top" style="padding-top:5px; color:#6F13CC; padding-left:10px">${Pending_Earnings}</td>
                                </tr>
                                <tr>
                                    <td align="left" valign="middle"><b>My Wallet Account:</b></td>
                                    <td align="right" valign="middle" style="padding-left:10px">
                                        <div style="color:#ad5a07" id="balance">{balance}</div>
                                    </td>
                                </tr>
                                <tr><td align="left" valign="top" colspan="2" style="padding-top:5px">{payment_perm}</td></tr>
                            </table>
				</div>
			</div>
            </div>
        </div>
        <div style="clear:both; width:100%; overflow:hidden; padding-top:30px">
            <span style="float:left; clear:both; font-weight:bold; text-shadow:0px 1px 1px #999; height:30px;">2.&nbsp;&nbsp;Chart</span>
            <div style="clear:both; overflow:hidden; width:100%">
                <table cellpadding="0" cellspacing="0" border="0" width="100%">
                    <tr>
                        <td align="left" valign="middle" id="selected_by_value" width="200px">
                            
                        </td>
                        <td align="center" valign="middle">
                            <table cellpadding="0" cellspacing="0" border="0">
                                <tr>
                                    <td align="left" valign="middle">
                                        <div style="float:left; width:11px; height:11px; background:#6F13CC; margin-top:2px;"></div>
                                        <div style="float:left; padding-left:5px">Total Earning</div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td align="right" valign="middle" width="200px">
                            <table cellpadding="0" cellspacing="0" border="0">
                                <tr>
                                    <td align="left" valign="middle" style="padding-right:10px"><b>Selected by:</b></td>
                                    <td align="left" valign="middle">
                                        <select id="selected_by" style="width:80px;" class="default" onchange="loadSelectBy()">
                                            <option value="0" selected="selected">Month</option>
                                            <option value="1">Year</option>
                                        </select>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
            <div style="width:100%; min-height:120px; clear:both; padding-top:5px" id="sales_chart" align="left"></div>
        </div>
        <div style="clear:both; width:100%; overflow:hidden; padding-top:30px">
            <span style="float:left; clear:both; font-weight:bold; text-shadow:0px 1px 1px #999; height:30px;">3.&nbsp;&nbsp;My Sponsor Tree</span>
       		<div style="clear:both; overflow:hidden; padding-top:20px; width:100%" id="saleRepListing"></div>
        </div>
    </div>
</div>
<input type="hidden" id="akey" name="akey" value="{repkey}" />
<script type="text/javascript" src="misc/scripts/jquery.tooltip.min.js"></script>
<script type="text/javascript">
var dataCharts = [];
var arr_years = [];
var year_selected = 0;
var Direct_sponsor = 0;
var Number_of_level = 0;
var dataUsers = [];
var slideshowSpeed = 999;
var from_date = parseFloat("{from_date}");
var to_date = parseFloat("{to_date}");
var todays = parseFloat("{todays}");
var interval;
function showRemaining_Time(){
	calRemainingTime();
	interval = setInterval(function(){
		viewRemaining_Time();
	}, slideshowSpeed);
}
function viewRemaining_Time(){
	todays ++;
	calRemainingTime();
}
function calRemainingTime(){
	var st = '';
	if(todays >= from_date && todays < to_date){
		var Remaining = to_date - todays;
		var days = parseInt(Remaining / (24*60*60));
		var Remaining_h = Remaining - days * (24*60*60); 
		var hours = parseInt(Remaining_h / (60*60));
		var Remaining_m = Remaining_h - hours * (60*60);
		var minutes = parseInt(Remaining_m / 60);
		var seconds = Remaining_m - minutes * 60;
		if(days > 1){
			st += days + ' days';	
		}else{
			st += 	days + ' day';	
		}
		st += ', ' + (hours > 9 ? hours : ('0'+hours)) + ':' + (minutes > 9 ? minutes : ('0'+minutes)) + ':' + (seconds > 9 ? seconds : ('0'+seconds));
	}else if(todays >= to_date){
		window.location.reload();	
	}
	$(".Remaining_Time").empty().append(st);
}
function showSaleRepTree(){
	var st = '';
	var max_member = Direct_sponsor;
	for(var i = 0; i < Number_of_level; i++){
		
		if(i == 0){
			st += '<div style="clear:both; overflow:hidden; width:100%">';
		}else{
			st += '<div style="clear:both; overflow:hidden; width:100%; border-top:1px dashed #CCC; padding-top:10px; margin-top:10px">';
		}
		if(i > 0){
			max_member = max_member * Direct_sponsor;	
		}
		var number_member = 0;
		var Pending_Earnings = 0;
		for(var j = 0; j < dataUsers.length; j++){
			if(dataUsers[j].level == i){
				number_member ++;
				Pending_Earnings += dataUsers[j].com;	
			}	
		}	
		st += '	<table cellpadding="0" cellspacing="0" border="0">';
		st += '		<tr>';
		st += '			<td align="left" valign="top">';
		st += '				<div style="float:left; overflow:hidden; width:180px">';
		st += '					<div style="clear:both; font-size:20px; color:#CCC; line-height:25px; font-weight:bold;">Level '+(i+1)+'</div>';
		st += '					<div style="clear:both; padding-top:4px">Total Member: '+number_format(number_member)+' of '+number_format(max_member)+'</div>';
		st += '					<div style="clear:both;">Pending Earning: $'+formatAsMoney(Pending_Earnings)+'</div>';
		st += '				</div>';
		st += '			</td>';
		st += '			<td align="left" valign="bottom" id="level_'+i+'"></td>';
		st += '		</tr>';
		st += '	</table>';
		st += '</div>';
	}
	$("#total_downline_member").empty().append(dataUsers.length);
	$("#saleRepListing").empty().append(st);
	showMemberLevel0();
}
function showMemberLevel0(){
	var members = '';
	var arr_level0 = [];
	for(var j = 0; j < dataUsers.length; j++){
		if(dataUsers[j].level == 0){
			arr_level0[arr_level0.length] = dataUsers[j];
			members += '<div class="member" id="member_'+dataUsers[j].uid+'" onclick="showMemberUser('+dataUsers[j].uid+',1)"><img src="../images/icon_p.png" border="0" align="absmiddle" />'+dataUsers[j].fn+' '+dataUsers[j].ln+' <span style="color:#B4285D">('+getTotalmemberByUser(dataUsers[j].uid)+')</span></div>';	
		}	
	}
	$("#level_0").empty().append(members);
	for(var i = 0; i < arr_level0.length; i++){
		showTooltip(arr_level0[i]);
	}	
}
function getTotalmemberByUser(uid){
	var members = 0;
	for(var j = 0; j < dataUsers.length; j++){
		if(dataUsers[j].author == uid){
			members ++;	
		}	
	}
	return members;
}
function showTooltipUpline(){
	var st = '<div style="clear:both;color:#B4285D; font-weight:bold; border-bottom:2px solid #961F5F; padding-bottom:3px; margin:5px 10px 5px 10px; overflow:hidden; width:400px">Member Information</div>';
	st += '<div style="clear:both;color:#000; width:400px; margin-right:10px; margin-left:10px; font-size:10px; overflow:hidden">';
	st += '	<table cellpadding="0" cellspacing="0" border="0">';
	st += '		<tr>';
	st += '			<td align="left" valign="top"><b>ID#:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px;">{legal_business_id_2}</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Legal Business Name:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">{legal_business_name_2}</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Full Name:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">{full_name}</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Address:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">{address}</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Phone:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">{phone}</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Fax:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">{fax}</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Email:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">{mail}</td>';
	st += '		</tr>';
	st += '	</table>';
	st += '</div>';
	$('.upline').tooltip({ 
		delay: 0, 
		track: true,
		showURL: false, 
		opacity:1,
		bodyHandler: function() {
			return st;
		} 
	});
}
function showTooltip(obj){
	var st = '<div style="clear:both;color:#B4285D; font-weight:bold; border-bottom:2px solid #961F5F; padding-bottom:3px; margin:5px 10px 5px 10px; overflow:hidden; width:400px">Member Information</div>';
	st += '<div style="clear:both; color:#000; width:400px; margin-right:10px; margin-left:10px; font-size:10px; overflow:hidden">';
	st += '	<table cellpadding="0" cellspacing="0" border="0">';
	st += '		<tr>';
	st += '			<td align="left" valign="top"><b>ID#:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px;">'+obj.LBI+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Legal Business Name:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">'+obj.LBN+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>First Name:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">'+obj.fn+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Last Name:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">'+obj.ln+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Address:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">'+obj.adr+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Phone:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">'+obj.phone+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Fax:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">'+obj.fax+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Email:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">'+obj.mail+'</td>';
	st += '		</tr>';
	st += '		<tr>';
	st += '			<td align="left" valign="top" style="padding-top:2px"><b>Purchased:</b></td>';
	st += '			<td align="left" valign="top" style="padding-left:10px; padding-top:2px">$'+formatAsMoney(obj.pur)+'</td>';
	st += '		</tr>';
	st += '	</table>';
	st += '</div>';
	$('#member_'+obj.uid).tooltip({ 
		delay: 0, 
		track: true,
		showURL: false, 
		opacity:1,
		bodyHandler: function() {
			return st;
		} 
	});
}
function showMemberUser(uid, level){
	for(var i = level; i < Number_of_level; i++){
		$("#level_"+i).empty();	
	}
	for(var j = 0; j < dataUsers.length; j++){
		if(dataUsers[j].level == (level-1)){
			if(document.getElementById("member_"+dataUsers[j].uid)){
				if(dataUsers[j].uid == uid)
					document.getElementById("member_"+dataUsers[j].uid).className = 'member_active';
				else document.getElementById("member_"+dataUsers[j].uid).className = 'member';	
			}	
		}
	}
	var members = '';
	var arr_level0 = [];
	for(var j = 0; j < dataUsers.length; j++){
		if(dataUsers[j].author == uid){
			arr_level0[arr_level0.length] = dataUsers[j];
			members += '<div class="member" id="member_'+dataUsers[j].uid+'" onclick="showMemberUser('+dataUsers[j].uid+','+(dataUsers[j].level+1)+')"><img src="../images/icon_p.png" border="0" align="absmiddle" />'+dataUsers[j].fn+' '+dataUsers[j].ln+' <span style="color:#B4285D">('+getTotalmemberByUser(dataUsers[j].uid)+')</span></div>';	
		}	
	}
	$("#level_"+level).empty().append(members);
	if(level>=2)
		return;
	for(var i = 0; i < arr_level0.length; i++){
		showTooltip(arr_level0[i]);
	}	
}
function AddNewAccount(){
	window.location = 'index.php/representatives/add';
	return false;
}
function loadDataChart(){
	arr_data_chart = [];
	arr_years = [];
	ShowLoadingObj({obj:document.getElementById("content_load"), image:"Loader-FloGradient16x16x.gif"});
	
	$.post("index.php/representatives/loadchart", {
		akey:document.getElementById("akey").value
	},function(data){
		HideLoadingObj(document.getElementById("content_load"));
		if(typeof(data) == 'object'){
			arr_years = data.objYear;
			dataCharts = data.chart;
			dataUsers = data.users.data;
			Direct_sponsor = data.users.Direct_sponsor;
			Number_of_level = data.users.Number_of_level;
		}
		loadYTD_Earnings();
		loadSelectBy();
		showSaleRepTree();
		showRemaining_Time();
	}, "json");
	
	return false;
}
function Export_to_Excel(){
	calculate_export();
	$.post("index.php/export/salerepresent_export&akey="+document.getElementById("akey").value,{
		type:'xls',
		year:year_selected,
		month_report:month_report,
		year_report:year_report
	},function(data){
		if(data.error == 'error'){
			alert(data.error);	
		}else{
			window.open("index.php/download&f=uploads/SaleRepresent_Report.xls");
		}
	},"json");
	return false;	
}
var month_report = [];
var year_report = [];
function calculate_export(){
	month_report = [];
	year_report = [];
	for(var i = 1; i < 13; i++){
		var obj = new Object();
		obj.year = year_selected;
		obj.month = i;
		obj.YTD_earnings = 0;
		obj.paid = 0;
		obj.balance = 0;
		month_report[month_report.length] = obj;	
	}
	for(var i = 0; i < month_report.length; i++){
		if(month_report[i].year > year_current) continue;
		else if(month_report[i].year == year_current){
			if(month_report[i].month > month_current) continue;	
		}
		var total_earning = 0;
		var total_paid = 0;
		for(var j = 0; j < dataCharts.length; j++){
			if(dataCharts[j].year < month_report[i].year){
				total_earning += dataCharts[j].YTD_earnings;
				total_paid += dataCharts[j].paid;	
			}else if(dataCharts[j].year == month_report[i].year && dataCharts[j].month <= month_report[i].month){
				total_earning += dataCharts[j].YTD_earnings;
				total_paid += dataCharts[j].paid;
			}
			if(dataCharts[j].year == month_report[i].year && dataCharts[j].month == month_report[i].month){
				month_report[i].YTD_earnings += dataCharts[j].YTD_earnings;
				month_report[i].paid += dataCharts[j].paid;
			}
		}
		var Balance = total_earning - total_paid;
		if(Balance < 0) Balance = 0;
		month_report[i].balance = Balance;
	}
	for(var i = year_selected-11; i < year_selected+1; i++){
		var obj = new Object();
		obj.year = i;
		obj.YTD_earnings = 0;
		obj.paid = 0;
		obj.balance = 0;
		year_report[year_report.length] = obj;	
	}
	for(var i = 0; i < year_report.length; i++){
		if(year_report[i].year > year_current) continue;
		var total_earning = 0;
		var total_paid = 0;
		for(var j = 0; j < dataCharts.length; j++){
			if(dataCharts[j].year <= year_report[i].year){
				total_earning += dataCharts[j].YTD_earnings;
				total_paid += dataCharts[j].paid;	
			}
			if(dataCharts[j].year == year_report[i].year){
				year_report[i].YTD_earnings += dataCharts[j].YTD_earnings;
				year_report[i].paid += dataCharts[j].paid;
			}
		}
		var Balance = total_earning - total_paid;
		if(Balance < 0) Balance = 0;
		year_report[i].balance = Balance;
	}	
}
function loadSelectBy(){
	var str = '';
	if(year_selected == 0){
		if(arr_years.length > 0) year_selected = arr_years[arr_years.length-1];
	}
	var select_by_value = parseInt(document.getElementById("selected_by").value, 10);
	if(year_selected > 0){
		loadSelectedByValue(select_by_value);
		LoadSalesChart(select_by_value);	
	}
}
function nextYear(){
	year_selected += 1;
	loadSelectBy();
}
function previousYear(){
	year_selected -= 1;
	loadSelectBy();
}
function loadSelectedByValue(select_by_value){  
	var str = '';
	if(year_selected > 0){
		if(select_by_value == 0){
			var arrow_left = '<img src="../images/arrow-left.png" border="0" />';
			var arrow_right = '<img src="../images/arrow-right.png" border="0" />';
			if(arr_years.length > 0){
				if(year_selected > arr_years[0]) arrow_left = '<img src="../images/arrow-left.png" border="0" style="cursor:pointer" onclick="previousYear()" />';
				if(year_selected < arr_years[arr_years.length-1]) arrow_right = '<img src="../images/arrow-right.png" border="0" style="cursor:pointer" onclick="nextYear()" />';
			}
			str += '<table cellpadding="0" cellspacing="0" border="0">';
			str += '<tr>';
			str += '<td align="left" valign="middle" style="font-weight:bold; padding-right:12px">Year '+year_selected+'</td>';			
			str += '<td align="left" valign="middle" style="padding-right:4px">'+arrow_left+'</td>';
			str += '<td align="left" valign="middle">'+arrow_right+'</td>';
			str += '</tr>';
			str += '</table>';	
		}else if(select_by_value == 1){
			var arrow_left = '<img src="../images/arrow-left.png" border="0" />';
			var arrow_right = '<img src="../images/arrow-right.png" border="0" />';
			if(arr_years.length > 0){
				if(year_selected-11 > arr_years[0]) arrow_left = '<img src="../images/arrow-left.png" border="0" style="cursor:pointer" onclick="previousYear()" />';
				if(year_selected < arr_years[arr_years.length-1]) arrow_right = '<img src="../images/arrow-right.png" border="0" style="cursor:pointer" onclick="nextYear()" />';
			}
			str += '<table cellpadding="0" cellspacing="0" border="0">';
			str += '<tr>';
			str += '<td align="left" valign="middle" style="font-weight:bold; padding-right:12px">From '+(year_selected-11)+' To '+year_selected+'</td>';
			str += '<td align="left" valign="middle" style="padding-right:4px">'+arrow_left+'</td>';
			str += '<td align="left" valign="middle">'+arrow_right+'</td>';
			str += '</tr>';
			str += '</table>';		
		}		
	}
	$("#selected_by_value").empty().append(str);
}
{load_month_current}	//month_current
{load_year_current}		//year_current
function loadYTD_Earnings(){
	var YTD_Earnings = 0;
	var YTD_pd = 0;
	for(var j = 0; j < dataCharts.length; j++){
		if(dataCharts[j].year == year_current){
			YTD_Earnings += dataCharts[j].YTD_earnings;
			YTD_pd += dataCharts[j].YTD_pd;
		}
	}
	$("#YTD_Earnings").empty().append(formatAsMoney(YTD_Earnings));
	$("#YTD_Personal_Discount").empty().append(formatAsMoney(YTD_pd));
	$("#year_current").empty().append(year_current);
}
function LoadSalesChart(select_by_value){
	var month_name = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
	var arr_data_chart = [];
	if(select_by_value == 0){
		for(var i = 1; i < 13; i++){
			var obj = new Object();
			obj.year = year_selected;
			obj.month = i;
			obj.YTD_earnings = 0;
			obj.paid = 0;
			obj.balance = 0;
			arr_data_chart[arr_data_chart.length] = obj;	
		}
		for(var i = 0; i < arr_data_chart.length; i++){
			if(arr_data_chart[i].year > year_current) continue;
			else if(arr_data_chart[i].year == year_current){
				if(arr_data_chart[i].month > month_current) continue;	
			}
			var total_earning = 0;
			var total_paid = 0;
			for(var j = 0; j < dataCharts.length; j++){
				if(dataCharts[j].year < arr_data_chart[i].year){
					total_earning += dataCharts[j].YTD_earnings;
					total_paid += dataCharts[j].paid;	
				}else if(dataCharts[j].year == arr_data_chart[i].year && dataCharts[j].month <= arr_data_chart[i].month){
					total_earning += dataCharts[j].YTD_earnings;
					total_paid += dataCharts[j].paid;
				}
				if(dataCharts[j].year == arr_data_chart[i].year && dataCharts[j].month == arr_data_chart[i].month){
					arr_data_chart[i].YTD_earnings += dataCharts[j].YTD_earnings;
					arr_data_chart[i].paid += dataCharts[j].paid;
				}
			}
			var Balance = total_earning - total_paid;
			if(Balance < 0) Balance = 0;
			arr_data_chart[i].balance = Balance;
		}
	}else{
		for(var i = year_selected-11; i < year_selected+1; i++){
			var obj = new Object();
			obj.year = i;
			obj.YTD_earnings = 0;
			obj.paid = 0;
			obj.balance = 0;
			arr_data_chart[arr_data_chart.length] = obj;	
		}
		for(var i = 0; i < arr_data_chart.length; i++){
			if(arr_data_chart[i].year > year_current) continue;
			var total_earning = 0;
			var total_paid = 0;
			for(var j = 0; j < dataCharts.length; j++){
				if(dataCharts[j].year <= arr_data_chart[i].year){
					total_earning += dataCharts[j].YTD_earnings;
					total_paid += dataCharts[j].paid;	
				}
				if(dataCharts[j].year == arr_data_chart[i].year){
					arr_data_chart[i].YTD_earnings += dataCharts[j].YTD_earnings;
					arr_data_chart[i].paid += dataCharts[j].paid;
				}
			}
			var Balance = total_earning - total_paid;
			if(Balance < 0) Balance = 0;
			arr_data_chart[i].balance = Balance;
		}	
	}
	var str = '';
	if(arr_data_chart.length > 0){
		str += '<table cellpadding="0" cellspacing="0" border="0"  width="100%" class="table-per" style="border:1px solid #D3D3D3">';
		if(select_by_value == 0){
			str += '<thead><tr><td align="left" class="td-row" width="76px" style="border-right:1px solid #D3D3D3;">&nbsp;</td>';
			for(var i = 0; i < 6; i++){
				if(arr_data_chart[i].month == month_current){
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; color:#FFAF0F; font-weight:bold">'+month_name[i]+'</td>';		
				}else{
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; font-weight:bold">'+month_name[i]+'</td>';	
				}	
			}
			str += '</tr></thead>';
			
			var YTD_earnings_col = '';
			var paid_col = '';
			var balance_col = '';
			for(var i = 0; i < 6; i++){
				YTD_earnings_col += '<td align="center" class="td-row" style="border-bottom:1px solid #EDEDED; color:#6F13CC;">$'+formatAsMoney(arr_data_chart[i].YTD_earnings, 2)+'</td>';
				//paid_col += '<td align="center" class="td-row" style="border-bottom:1px solid #EDEDED;color:#00a651;">$'+formatAsMoney(arr_data_chart[i].paid, 2)+'</td>';
				//balance_col += '<td align="center" class="td-row" style="border-bottom:1px solid #EDEDED;color:#ad5a07;">$'+formatAsMoney(arr_data_chart[i].balance, 2)+'</td>';
			}
			str += '<tr><td class="td-row" align="left" style="color:#6F13CC;border-bottom:1px solid #EDEDED;font-weight:bold">Total Earnings</td>' + YTD_earnings_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#00a651;border-bottom:1px solid #EDEDED;font-weight:bold">Paid</td>' + paid_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#ad5a07;border-bottom:1px solid #EDEDED;font-weight:bold">Balance</td>' + balance_col + '</tr>';
			
			
			str += '<thead><tr><td align="left" class="td-row" style="border-right:1px solid #D3D3D3; background-color:#CD87FF; color:#6F13CC;">&nbsp;</td>';
			for(var i = 6; i < 12; i++){
				if(arr_data_chart[i].month == month_current){
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; color:#FFAF0F; font-weight:bold">'+month_name[i]+'</td>';	
				}else{
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; font-weight:bold">'+month_name[i]+'</td>';	
				}	
			}
			str += '</tr></thead>';
			
			var YTD_earnings_col = '';
			var paid_col = '';
			var balance_col = '';
			for(var i = 6; i < 12; i++){
				YTD_earnings_col += '<td align="center" class="td-row" style="color:#6F13CC;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].YTD_earnings, 2)+'</td>';
				//paid_col += '<td align="center" class="td-row" style="color:#00a651;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].paid, 2)+'</td>';
				//balance_col += '<td align="center" class="td-row" style="color:#ad5a07;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].balance, 2)+'</td>';
			}
			str += '<tr><td class="td-row" align="left" style="color:#6F13CC;border-bottom:1px solid #EDEDED; font-weight:bold">Total Earnings</td>' + YTD_earnings_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#00a651;border-bottom:1px solid #EDEDED;font-weight:bold">Paid</td>' + paid_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#ad5a07;border-bottom:1px solid #EDEDED;font-weight:bold">Balance</td>' + balance_col + '</tr>';
			
		}else if(select_by_value == 1){
			str += '<thead><tr><td align="left" width="76px" class="td-row" style="border-right:1px solid #D3D3D3; background-color:#CD87FF; color:#6F13CC;">&nbsp;</td>';
			for(var i = 0; i < 6; i++){
				if(arr_data_chart[i].year == year_current){
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; color:#FFAF0F; font-weight:bold">'+arr_data_chart[i].year+'</td>';	
				}else{
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; font-weight:bold">'+arr_data_chart[i].year+'</td>';	
				}	
			}
			str += '</tr></thead>';	
			var YTD_earnings_col = '';
			var paid_col = '';
			var balance_col = '';
			for(var i = 0; i < 6; i++){
				YTD_earnings_col += '<td align="center" style="color:#6F13CC;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].YTD_earnings, 2)+'</td>';
				//paid_col += '<td align="center" style="color:#00a651;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].paid, 2)+'</td>';
				//balance_col += '<td align="center" style="color:#ad5a07;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].balance, 2)+'</td>';
			}
			str += '<tr><td class="td-row" align="left" style="color:#6F13CC;border-bottom:1px solid #EDEDED; font-weight:bold">Total Earnings</td>' + YTD_earnings_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#00a651;border-bottom:1px solid #EDEDED;font-weight:bold">Paid</td>' + paid_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#ad5a07;border-bottom:1px solid #EDEDED;font-weight:bold">Balance</td>' + balance_col + '</tr>';
			
			str += '<thead><tr><td align="left" width="76px" class="td-row" style="border-right:1px solid #D3D3D3; background-color:#CD87FF; color:#6F13CC;">&nbsp;</td>';
			for(var i = 6; i < 12; i++){
				if(arr_data_chart[i].year == year_current){
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; color:#FFAF0F; font-weight:bold">'+arr_data_chart[i].year+'</td>';	
				}else{
					str += '<td width="76px"  align="center" class="td-row" valign="middle" style="border-right:1px solid #D3D3D3; font-weight:bold">'+arr_data_chart[i].year+'</td>';	
				}	
			}
			str += '</tr></thead>';	
			var YTD_earnings_col = '';
			var paid_col = '';
			var balance_col = '';
			for(var i = 6; i < 12; i++){
				YTD_earnings_col += '<td align="center" style="color:#6F13CC;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].YTD_earnings, 2)+'</td>';
				//paid_col += '<td align="center" style="color:#00a651;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].paid, 2)+'</td>';
				//balance_col += '<td align="center" style="color:#ad5a07;border-bottom:1px solid #EDEDED;">$'+formatAsMoney(arr_data_chart[i].balance, 2)+'</td>';
			}
			str += '<tr><td class="td-row" align="left" style="color:#6F13CC;border-bottom:1px solid #EDEDED; font-weight:bold">Total Earnings</td>' + YTD_earnings_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#00a651;border-bottom:1px solid #EDEDED;font-weight:bold">Paid</td>' + paid_col + '</tr>';
			//str += '<tr><td class="td-row" align="left" style="color:#ad5a07;border-bottom:1px solid #EDEDED;font-weight:bold">Balance</td>' + balance_col + '</tr>';
			
		}		
		str += '</table>';
		
	}	
	$("#sales_chart").empty().append(str);
}
$(function() {
	loadDataChart();
	if(document.getElementById("payment_form")){
		$("#payment_form").colorbox({
			initialWidth:70,
			initialHeight:50,		
			height:false,
			opacity:0.2,
			scrolling: false
		});			
	}
	showTooltipUpline();
});
</script>